function settingHide(){$(".table-setting").fadeOut()}function detailDrop(e,t){var i=$(e).next(".h-r-drop");if("block"==i.css("display"))return i.hide(),!1;i.show(),$(".layer-detail").one("click",function(){$(".h-r-drop").hide()}),t.stopPropagation()}function customerShow(){$("#detail").modal("show")}function addCustomer(){$("#customer").modal("show")}function menuDropdown(e){$(e).dropdown()}function CustomHead(){console.log("自定义表头"),$("#customHead").modal("show")}function listMove(e){var t="left",i="right",l=["left","right"],a=["right","left"];e>=2?t=i="right":(t=a[e],i=l[e]);var n,d=$("#list-"+t),c=$("#list-"+i),r=d.jqxListBox("getSelectedItems");if(r.length>0&&void 0!=r[0]){var o=d.jqxListBox("getSelectedIndex");n=2==e?o-1:3==e?o+1:d.jqxListBox("getSelectedIndex"),d.jqxListBox("removeAt",o),c.jqxListBox("insertAt",{label:r[0].label,value:r[0].value},n),c.jqxListBox("selectItem",r[0].value)}}function customSubmit(){var e=$("#list-right").jqxListBox("getItems"),t=$("#list-left").jqxListBox("getItems");$("#jqxtable").jqxGrid("beginupdate");for(var i=0;i<e.length;i++)$("#jqxtable").jqxGrid("showcolumn",e[i].value);for(var i=0;i<t.length;i++)$("#jqxtable").jqxGrid("hidecolumn",t[i].value);$("#jqxtable").jqxGrid("endupdate"),$("#customHead").modal("hide")}function customAdd(){alert("","添加成功",function(){$("#customer").modal("hide")},{type:"success"})}function tags(e){var t=$(e),i=t.parent(".tags-li");if(i.hasClass("active"))return!1;var l=i.index(".tags-li"),a=i.parents(".tags"),n=a.next(),d=$(".tags-con-li:eq("+l+")");a.find(".tags-li").removeClass("active"),i.addClass("active"),n.find(".tags-con-li").removeClass("active"),d.addClass("active")}function detail(e){var t=$(e).parents(".list-title").next(".list-main");$(e).hasClass("active")?(t.show(),$(e).removeClass("active")):(t.hide(),$(e).addClass("active"))}$(document).ready(function(){for(var e=[],t=0;t<90;t++){var i;i={cellphone:"13699273847",company:"北京联云天下",position:"打杂",createdTime:"2017-03-31",comAdress:"建外SOHO西区",progress:"",lastActionTime:"",comType:"",mainProduct:"",customerSource:"企业导入-客户 (3)",isDistribution:"1",actionType:"",remark:"1",operName:"",registCapi:"",lastAction:"",email:"1",wechat:"1",qq:"",callDuration:"1",callDownload:"",msgState:"",endcallMsgStatus:"",cellphone2:"",gender:"",birthday:"",reception:"",telephone:"1012345678",fax:"1012345681",spare1:"",spare2:"",spare3:"",spare4:"",spare5:""};var l=["刘晓辉","王佳印","艾云鹤","王佳怡","罗一山","刘宇"],a=["","新飞"];i.cusid=parseInt(90*Math.random()),i.cusname=l[parseInt(6*Math.random())],i.username=a[parseInt(2*Math.random())],i.actState=parseInt(2*Math.random()),i.lock=parseInt(2*Math.random()),e.push(i)}var n={datatype:"json",datafields:[{name:"cusid",type:"string"},{name:"cusname",type:"string"},{name:"cellphone",type:"string"},{name:"company",type:"string"},{name:"position",type:"string"},{name:"createdTime",type:"string"},{name:"userName",type:"string"},{name:"comAdress",type:"string"},{name:"progress",type:"string"},{name:"lastActionTime",type:"string"},{name:"comType",type:"string"},{name:"mainProduce",type:"string"},{name:"customerSource",type:"string"},{name:"actState",type:"string"},{name:"isDistribution",type:"string"},{name:"actionType",type:"string"},{name:"remark",type:"string"},{name:"operName",type:"string"},{name:"registCapi",type:"string"},{name:"lastAction",type:"string"},{name:"email",type:"string"},{name:"wechat",type:"string"},{name:"qq",type:"string"},{name:"callDuration",type:"string"},{name:"callDownload",type:"string"},{name:"mailState",type:"string"},{name:"endcallMsgStatus",type:"string"},{name:"cellphone2",type:"string"},{name:"gender",type:"string"},{name:"birthday",type:"string"},{name:"reception",type:"string"},{name:"telephone",type:"string"},{name:"fax",type:"string"},{name:"spare1",type:"string"},{name:"spare2",type:"string"},{name:"spare3",type:"string"},{name:"spare4",type:"string"},{name:"spare5",type:"string"},{name:"lock",type:"int"}],localdata:e},d=new $.jqx.dataAdapter(n),c=[],r=function(e,t,i,l,a,n){if(c.indexOf(e)>=0)return!1},o=function(e,t,i,l,a,n){},s=[{text:'<i class="icon icon-table"></i>',datafield:"header",editable:!1,width:20,pinned:!0,sortable:!1,filterable:!1},{text:"客户名称",datafield:"cusname",width:80,pinned:!0,cellbeginedit:r,cellendedit:o,cellsrenderer:function(e,t,i,l,a,n){return 1==n.lock?(c.indexOf(e)<0&&c.push(e),'<i class="icon-lock" data-id="'+n.cusid+'"></i><div class="jqx-grid-cell-left-align" data-id="'+n.cusid+'">'+i+"</div>"):'<i class="" data-id="'+n.cusid+'"></i><div class="jqx-grid-cell-left-align" data-id="'+n.cusid+'">'+i+"</div>"},filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"手机号码",datafield:"cellphone",width:120,cellbeginedit:r,cellendedit:o,filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"职位",datafield:"position",width:60,cellbeginedit:r,cellendedit:o,filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"销售进度",datafield:"progress",width:120,cellbeginedit:r,cellendedit:o,filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"创建时间",datafield:"createdTime",minwidth:120,cellbeginedit:r,cellendedit:o,filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"联系时间",datafield:"lastActionTime",minwidth:120,cellbeginedit:r,cellendedit:o,filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"跟进人",datafield:"userName",minwidth:120,cellbeginedit:r,cellendedit:o,filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"公司名称",datafield:"company",minwidth:120,cellbeginedit:r,cellendedit:o,filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"公司地址",datafield:"comAdress",minwidth:120,cellbeginedit:r,cellendedit:o,filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"公司类型",datafield:"comType",minwidth:120,cellbeginedit:r,cellendedit:o,filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"经营范围",datafield:"mainProduce",minwidth:120,cellbeginedit:r,cellendedit:o,filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"企业法人",datafield:"operName",minwidth:120,cellbeginedit:r,cellendedit:o,filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"数据来源",datafield:"customerSource",minwidth:120,cellbeginedit:r,cellendedit:o,filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"沟通状态",datafield:"actState",minwidth:120,cellbeginedit:r,cellendedit:o,cellsrenderer:function(e,t,i,l,a,n){return'<div class="jqx-grid-cell-text" data-id="'+n.cusid+'">'+("0"==i.toString()?"已沟通":"未沟通")+"</div>"},filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"分配状态",datafield:"isDistribution",minwidth:120,cellbeginedit:r,cellendedit:o,filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"电话结果",datafield:"actionType",minwidth:120,cellbeginedit:r,cellendedit:o,filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"电话标签",datafield:"lastAction",minwidth:120,cellbeginedit:r,cellendedit:o,filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"备注",datafield:"remark",minwidth:120,cellbeginedit:r,cellendedit:o,filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"注册资本",datafield:"registCapi",minwidth:120,cellbeginedit:r,cellendedit:o,filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"邮箱",datafield:"email",minwidth:120,cellbeginedit:r,cellendedit:o,filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"微信",datafield:"wechat",minwidth:120,cellbeginedit:r,cellendedit:o,filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"QQ",datafield:"qq",minwidth:120,cellbeginedit:r,cellendedit:o,filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"短信状态",datafield:"msgState",minwidth:120,cellbeginedit:r,cellendedit:o,filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"邮件状态",datafield:"mailState",minwidth:120,cellbeginedit:r,cellendedit:o,filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"挂机短信状态",datafield:"endcallMsgStatus",minwidth:120,cellbeginedit:r,cellendedit:o,filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"手机2",datafield:"cellphone2",minwidth:120,cellbeginedit:r,cellendedit:o,filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"性别",datafield:"gender",minwidth:120,cellbeginedit:r,cellendedit:o,filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"生日",datafield:"birthday",minwidth:120,cellbeginedit:r,cellendedit:o,filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"前台电话",datafield:"reception",minwidth:120,cellbeginedit:r,cellendedit:o,filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"座机",datafield:"telephone",minwidth:120,cellbeginedit:r,cellendedit:o,filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"传真",datafield:"fax",minwidth:120,cellbeginedit:r,cellendedit:o,filtertype:"custom",createfilterpanel:function(e,t){u(t,e)}},{text:"备用1",datafield:"spare1",minwidth:120,cellbeginedit:r,cellendedit:o,filterable:!1},{text:"备用2",datafield:"spare2",minwidth:120,cellbeginedit:r,cellendedit:o,filterable:!1},{text:"备用3",datafield:"spare3",minwidth:120,cellbeginedit:r,cellendedit:o,filterable:!1},{text:"备用4",datafield:"spare4",minwidth:120,cellbeginedit:r,cellendedit:o,filterable:!1},{text:"备用5",datafield:"spare5",minwidth:120,cellbeginedit:r,cellendedit:o,filterable:!1},{text:" ",datafield:"callDuration",width:35,editable:!1,sortable:!1,filterable:!1,cellsrenderer:function(e,t,i,l,a,n){return'<i class="icon v-icon video"  data-id="'+n.cusid+'"></i>'}},{text:" ",datafield:"callDownload",width:35,editable:!1,sortable:!1,filterable:!1,cellsrenderer:function(e,t,i,l,a,n){return'<i class="icon v-icon download"   data-id="'+n.cusid+'"></i>'}}],u=function(t,i){var l=$("<input class='filter-input' />"),a=$("<div class='filter-btn-box'></div>"),n=$('<span class="filter-button" tabindex="0" >筛选</span>');a.append(n);var d=$('<span class="filter-button" tabindex="0" >清除</span>');a.append(d),t.append(l),t.append(a),n.jqxButton(),d.jqxButton(),console.log(e);var c=$("#jqxtable"),r={localdata:e},o=new $.jqx.dataAdapter(r,{autoBind:!1,autoSort:!0,autoSortField:i,async:!1,uniqueDataFields:[i]}),s=c.jqxGrid("getcolumn",i);l.jqxInput({placeHolder:"请输入"+s.text,popupZIndex:9999999,displayMember:i,source:o}),l.keyup(function(e){13===e.keyCode&&n.trigger("click")}),n.click(function(){var e=new $.jqx.filter,t=l.val(),a=e.createfilter("stringfilter",t,"contains");e.addfilter(1,a),c.jqxGrid("addfilter",i,e),c.jqxGrid("applyfilters"),c.jqxGrid("closemenu")}),n.keydown(function(e){13===e.keyCode&&n.trigger("click")}),d.click(function(){c.jqxGrid("removefilter",i),c.jqxGrid("applyfilters"),c.jqxGrid("closemenu")}),d.keydown(function(e){13===e.keyCode&&d.trigger("click"),l.val("")})};$("#jqxtable").on("cellclick",function(e){if("cusname"!=e.args.datafield)return!1;customerShow()}),$("#jqxtable").on("rowselect rowunselect",function(e){var t=$("#jqxtable").jqxGrid("getselectedrowindexes"),i=$(".table-setting");t.length>0?i.fadeIn():i.fadeOut(),i.find(".count-select").text(t.length)}),$(".table-setting").find(".close-gray").click(function(){$(".table-setting").fadeOut()}),$("#jqxtable").on("columnclick",function(e){console.log(e.args),"header"==e.args.datafield&&CustomHead()}),$("#jqxtable").jqxGrid({width:"100%",height:"100%",source:d,columnsresize:!0,scrollbarsize:7,sortable:!0,filterable:!0,ready:function(){},scrollmode:"logical",altrows:!0,pageable:!0,pagesize:20,pagermode:"simple",editable:!0,editmode:"dblclick",selectionmode:"checkbox",rowsheight:40,pagerheight:50,columns:s})}),$(function(){$(".h-r-drop").click(function(e){e.stopPropagation()})}),$(function(){var e=[],t=[{label:"客户姓名",value:"cusname"},{label:"手机号码",value:"cellphone"},{label:"职位",value:"position"},{label:"公司名称",value:"company"},{label:"公司地址",value:"comAdress"},{label:"销售进度",value:"progress"},{label:"创建时间",value:"createdTime"},{label:"联系时间",value:"lastActionTime"},{label:"跟进人",value:"userName"},{label:"公司类型",value:"comType"},{label:"经营范围",value:"mainProduce"},{label:"企业法人",value:"operName"},{label:"数据来源",value:"customerSource"},{label:"沟通状态",value:"actState"},{label:"分配状态",value:"isDistribution"},{label:"电话结果",value:"actionType"},{label:"电话标签",value:"lastAction"},{label:"备注",value:"remark"},{label:"注册资本",value:"registCapi"},{label:"邮箱",value:"email"},{label:"微信",value:"wechat"},{label:"QQ",value:"qq"},{label:"通话录音",value:"callDuration"},{label:"短信状态",value:"msgState"},{label:"邮件状态",value:"mailState"},{label:"挂机短信状态",value:"endcallMsgStatus"},{label:"手机2",value:"cellphone2"},{label:"性别",value:"gender"},{label:"生日",value:"birthday"},{label:"前台电话",value:"reception"},{label:"座机",value:"telephone"},{label:"传真",value:"fax"},{label:"备用1",value:"spare1"},{label:"备用2",value:"spare2"},{label:"备用3",value:"spare3"},{label:"备用4",value:"spare4"},{label:"备用5",value:"spare5"}];$("#list-left").jqxListBox({width:200,height:335,scrollBarSize:7,source:e}),$("#list-right").jqxListBox({width:200,height:335,scrollBarSize:7,source:t})});